---
title: "JS中的事件相关"
date: 2017-06-13
categories: JavaScript
description: 最近在开发App过程中，发现了移动端的click事件在有些浏览器上总有300ms的延迟，查询了一下，顺便又学习了一下JS的事件冒泡、事件委托等。
tags: 
- JavaScript
- 事件
---

## 关于JS中的事件相关问题
最近在开发App过程中，发现了移动端的click事件在有些浏览器上总有300ms的延迟，大惑不解，查询了下，发现是为了防止处理如翻页这样复杂的手势。  
在用户做翻页或双击放大等操作时，是先将手指触碰到屏幕（此时理应已经触发了click事件），然后再上下移动手指，浏览器开发厂商为了识别这种事件，所以加入了300ms延迟的处理。  
解决方法很简单，引入一个fastclick就行了。但是在查询过程中，又回顾了一下之前学习的事件知识，记录下来。  

#### 事件冒泡  
>事件冒泡是指 事件开始时由最具体的元素（文档中嵌套层次最深的那个节点）接受，然后逐级向上传播到较为不具体的节点（文档）。  

stopPropagation()方法可以阻止事件冒泡。  

#### 移动端的点击穿透  
点击穿透现象有3种：
点击穿透问题：点击蒙层（mask）上的关闭按钮，蒙层消失后发现触发了按钮下面元素的click事件。
蒙层的关闭按钮绑定的是touch事件，而按钮下面元素绑定的是click事件，touch事件触发之后，蒙层消失了，300ms后这个点的click事件fire，event的target自然就是按钮下面的元素，因为按钮跟蒙层一起消失了。

跨页面点击穿透问题：如果按钮下面恰好是一个有href属性的a标签，那么页面就会发生跳转。
因为 a标签跳转默认是click事件触发 ，所以原理和上面的完全相同。

另一种跨页面点击穿透问题：这次没有mask了，直接点击页内按钮跳转至新页，然后发现新页面中对应位置元素的click事件被触发了。  

#### 事件委托
>事件委托是指利用“事件冒泡”，只通过指定一个事件处理程序，来管理某一类型的所有事件。也就是说，当此事件处理程序被触发时，通过当前事件对象中的target来确认究竟是在哪个元素触发的事件，从而达到一次注册 处理多个元素触发事件的目的。

比如一个超长的ul里面每个li都有不同的点击事件，那么我们如果使用循环绑定的话费时费力，就可以获取ul，给ul绑定一个事件，然后获取Event里面的target就可以知道是具体哪一个li被操作，这里就是运用了事件委托和事件冒泡的原理。  

-
现在主流框架其实都已经将事件绑定和处理都封装了，如果你是框架的强依赖开发者的话，很多问题你可能并不会遇到，如你几乎不需要理解Event对象中的target。  
但是作为一个前端开发，js的功力是不能被拉下的。